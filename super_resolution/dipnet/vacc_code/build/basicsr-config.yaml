model:
  name: DIPNet
  inputs:
    input: [1, 3, 1080, 1920]
  checkpoint: model_best.torchscript.pt

engine:
  type: vacc
  dtype: int8
  common:
    data_transport_mode: 1
    enable_graph_partition: true
  add_extra_ops_to_graph:
    type: null
  calibration:
    calibrate_mode: max
    quantize_per_channel: true

dataset:
  path: /media/temp/DIV2K/DIV2K_valid_LR_bicubic/X2
  sampler:
    suffix: null
    get_data_num: 100
  transform_ops:
    - type: DecodeImage
    - type: Resize
      size: [1080, 1920]
    - type: Normalize
      norm_type: null
    - type: ToTensor

workspace:
  work_dir: ./deploy_weights/
  enable_ir: true
  save_log: true


# cd /home/simplew/code/vamc/vamp/2.1.0

# (base) simplew@simplew-OptiPlex-7090:~/code/vamc/vamp/2.1.0$ ./vamp_2.1.0 -m /home/simplew/code/vastmodelzoo/0818/algorithm_modelzoo/deploy_weights/dipnet_x2_noSE_mini_net_g_368000-int8-percentile-1_3_1080_1920-vacc/mod --vdsp_params /home/simplew/code/vastmodelzoo/0828/algorithm_modelzoo/super_resolution/dipnet/vacc_code/vdsp_params/official-dipnet-vdsp_params.json -i 1 p 1 -b 1
 
# LoadLibrary VaclBatchInferTensor from /opt/vastai/vastpipe/vastpipe/calculators/libVaclBatchInferTensor.so
# version_path: /opt/vastai/vastpipe/vastpipe/version
# VastPipe Version: 2.2.5
# load model and init graph...
# [23491]: Initializing VACM logger with config: /var/log/vastai/fnlog/vslog.cfg.
# model input shape 0: [3,1080,1920], dtype: u1
# load model and init graph done
# - number of instances in each device: 1
#   devices: [0]
#   batch size: 1
#   ai utilize (%): 91.6641
#   temperature (Â°C): 49.5416
#   card power (W): 45.3943
#   die memory used (MB): 1678.05
#   throughput (qps): 23.7118
#   e2e latency (us):
#     avg latency: 105270
#     min latency: 49422
#     max latency: 133523
#     p50 latency: 91416
#     p90 latency: 126463
#     p95 latency: 126500
#     p99 latency: 126589
#   model latency (us):
#     avg latency: 105222
#     min latency: 49373
#     max latency: 133477
#     p50 latency: 91360
#     p90 latency: 126410
#     p95 latency: 126447
#     p99 latency: 126531